<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="Client database."><title>ab_client_database - Rust</title><script>if(window.location.protocol!=="file:")document.head.insertAdjacentHTML("beforeend","SourceSerif4-Regular-6b053e98.ttf.woff2,FiraSans-Italic-81dc35de.woff2,FiraSans-Regular-0fe48ade.woff2,FiraSans-MediumItalic-ccf7e434.woff2,FiraSans-Medium-e1aa3f0a.woff2,SourceCodePro-Regular-8badfe75.ttf.woff2,SourceCodePro-Semibold-aa29a496.ttf.woff2".split(",").map(f=>`<link rel="preload" as="font" type="font/woff2"href="../static.files/${f}">`).join(""))</script><link rel="stylesheet" href="../static.files/normalize-9960930a.css"><link rel="stylesheet" href="../static.files/rustdoc-b7b9f40b.css"><meta name="rustdoc-vars" data-root-path="../" data-static-root-path="../static.files/" data-current-crate="ab_client_database" data-themes="" data-resource-suffix="" data-rustdoc-version="1.95.0-nightly (9e79395f9 2026-02-10)" data-channel="nightly" data-search-js="search-fb33671b.js" data-stringdex-js="stringdex-b897f86f.js" data-settings-js="settings-170eb4bf.js" ><script src="../static.files/storage-f9617a14.js"></script><script defer src="../crates.js"></script><script defer src="../static.files/main-12f88f4f.js"></script><noscript><link rel="stylesheet" href="../static.files/noscript-f7c3ffd8.css"></noscript><link rel="alternate icon" type="image/png" href="../static.files/favicon-32x32-eab170b8.png"><link rel="icon" type="image/svg+xml" href="../static.files/favicon-044be391.svg"></head><body class="rustdoc mod crate"><a class="skip-main-content" href="#main-content">Skip to main content</a><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><rustdoc-topbar><h2><a href="#">Crate ab_client_database</a></h2></rustdoc-topbar><nav class="sidebar"><div class="sidebar-crate"><h2><a href="../ab_client_database/index.html">ab_<wbr>client_<wbr>database</a><span class="version">0.0.1</span></h2></div><div class="sidebar-elems"><ul class="block"><li><a id="all-types" href="all.html">All Items</a></li></ul><section id="rustdoc-toc"><h3><a href="#">Sections</a></h3><ul class="block top-toc"><li><a href="#high-level-architecture-overview" title="High-level architecture overview">High-level architecture overview</a></li></ul><h3><a href="#modules">Crate Items</a></h3><ul class="block"><li><a href="#modules" title="Modules">Modules</a></li><li><a href="#structs" title="Structs">Structs</a></li><li><a href="#enums" title="Enums">Enums</a></li></ul></section><div id="rustdoc-modnav"></div></div></nav><div class="sidebar-resizer" title="Drag to resize sidebar"></div><main><div class="width-limiter"><section id="main-content" class="content" tabindex="-1"><div class="main-heading"><h1>Crate <span>ab_<wbr>client_<wbr>database</span>&nbsp;<button id="copy-path" title="Copy item path to clipboard">Copy item path</button></h1><rustdoc-toolbar></rustdoc-toolbar><span class="sub-heading"><a class="src" href="../src/ab_client_database/lib.rs.html#1-1800">Source</a> </span></div><details class="toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p>Client database.</p>
<h3 id="high-level-architecture-overview"><a class="doc-anchor" href="#high-level-architecture-overview">§</a>High-level architecture overview</h3>
<p>The database operates on <a href="storage_backend/trait.ClientDatabaseStorageBackend.html" title="trait ab_client_database::storage_backend::ClientDatabaseStorageBackend"><code>ClientDatabaseStorageBackend</code></a>, which is backed by <a href="storage_backend/struct.AlignedPage.html" title="struct ab_client_database::storage_backend::AlignedPage"><code>AlignedPage</code></a>s
that can be read or written. Pages contain <code>StorageItem</code>s, one storage item can occupy one or
more pages, but pages always belong to a single storage item. Pages are the smallest unit and
align nicely with the hardware architecture of modern SSDs. Each page starts with a prefix that
describes the contents of the page. <code>StorageItem</code> always starts at the multiple of the
<code>u128</code>/16 bytes, allowing for direct memory mapping onto target data structures.</p>
<p>Individual pages are grouped into page groups (configurable via <a href="struct.ClientDatabaseOptions.html" title="struct ab_client_database::ClientDatabaseOptions"><code>ClientDatabaseOptions</code></a>). Page
groups can be permanent and ephemeral. Permanent page groups store information that is never
going to be deleted, like segment headers. Ephemeral page groups store the majority of the
information about blocks, blockchain state and other things that are being created all the time.
Once information in an ephemeral page group is too old and no longer needed, it can be
repurposed for a new permanent or ephemeral page group. There are different kinds of page groups
defined in <code>PageGroupKind</code>, and each variant has independent sequence numbers.</p>
<p>Page groups are append-only, there is only one active permanent and one ephemeral page group.
They are appended with more pages containing storage items until there is no space to add a
complete storage item, after which the next page group is started.</p>
<p>Ephemeral page groups can be freed only when they contain 100% outdated storage items.
Individual pages can’t be freed.</p>
<p>Each storage item has a sequence number and checksums that help to define the global ordering
and check whether a storage item was written fully. Upon restart, the page group containing the
latest storage items is found, and the latest fully written storage item is identified to
reconstruct the database state.</p>
<p>Each page group starts with a <code>StorageItemPageGroupHeader</code> storage item for easier
identification.</p>
<p>The database is typically contained in a single file (though in principle could be contained in
multiple if necessary). Before the database can be used, it needs to be formatted with a
specific size (it is possible to increase the size afterward) before it can be used. It is
expected (but depends on the storage backend) that the whole file size is pre-allocated on disk
and no writes will fail due to lack of disk space (which could be the case with a sparse file).</p>
</div></details><h2 id="modules" class="section-header">Modules<a href="#modules" class="anchor">§</a></h2><dl class="item-table"><dt><a class="mod" href="storage_backend/index.html" title="mod ab_client_database::storage_backend">storage_<wbr>backend</a></dt></dl><h2 id="structs" class="section-header">Structs<a href="#structs" class="anchor">§</a></h2><dl class="item-table"><dt><a class="struct" href="struct.ClientDatabase.html" title="struct ab_client_database::ClientDatabase">Client<wbr>Database</a></dt><dd>Client database</dd><dt><a class="struct" href="struct.ClientDatabaseFormatOptions.html" title="struct ab_client_database::ClientDatabaseFormatOptions">Client<wbr>Database<wbr>Format<wbr>Options</a></dt><dd>Options for <a href="struct.ClientDatabase.html" title="struct ab_client_database::ClientDatabase"><code>ClientDatabase</code></a></dd><dt><a class="struct" href="struct.ClientDatabaseOptions.html" title="struct ab_client_database::ClientDatabaseOptions">Client<wbr>Database<wbr>Options</a></dt><dd>Options for <a href="struct.ClientDatabase.html" title="struct ab_client_database::ClientDatabase"><code>ClientDatabase</code></a></dd><dt><a class="struct" href="struct.DatabaseId.html" title="struct ab_client_database::DatabaseId">Database<wbr>Id</a></dt><dd>Unique identifier for a database</dd><dt><a class="struct" href="struct.GenesisBlockBuilderResult.html" title="struct ab_client_database::GenesisBlockBuilderResult">Genesis<wbr>Block<wbr>Builder<wbr>Result</a></dt></dl><h2 id="enums" class="section-header">Enums<a href="#enums" class="anchor">§</a></h2><dl class="item-table"><dt><a class="enum" href="enum.ClientDatabaseError.html" title="enum ab_client_database::ClientDatabaseError">Client<wbr>Database<wbr>Error</a></dt><dt><a class="enum" href="enum.ClientDatabaseFormatError.html" title="enum ab_client_database::ClientDatabaseFormatError">Client<wbr>Database<wbr>Format<wbr>Error</a></dt><dd>Error for <a href="struct.ClientDatabase.html#method.format" title="associated function ab_client_database::ClientDatabase::format"><code>ClientDatabase::format()</code></a></dd></dl></section></div></main></body></html>