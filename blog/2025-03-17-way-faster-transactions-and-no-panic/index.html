<!doctype html><html lang=en dir=ltr class=scroll-smooth data-default-appearance=dark data-auto-appearance=true><head><meta charset=utf-8><meta http-equiv=content-language content="en"><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=X-UA-Compatible content="ie=edge"><meta name=theme-color><title>Way faster transactions and no-panic &#183; Project Abundance</title><meta name=title content="Way faster transactions and no-panic &#183; Project Abundance"><meta name=description content="Performance optimizations for transactions and other improvements"><meta name=keywords content="status-update,"><link rel=canonical href=https://abundance.build/blog/2025-03-17-way-faster-transactions-and-no-panic/><link type=text/css rel=stylesheet href=/css/main.bundle.min.fd951ea54edeca1b6b08c8bbf3c93c284de4c78daf63a71d8016939775734cf68700f1662ed31d870100c676cbe1f65d150635cf368b874c49fc75147bcb04a9.css integrity="sha512-/ZUepU7eyhtrCMi788k8KE3kx42vY6cdgBaTl3VzTPaHAPFmLtMdhwEAxnbL4fZdFQY1zzaLh0xJ/HUUe8sEqQ=="><script type=text/javascript src=/js/appearance.min.516a16745bea5a9bd011138d254cc0fd3973cd55ce6e15f3dec763e7c7c2c7448f8fe7b54cca811cb821b0c7e12cd161caace1dd794ac3d34d40937cbcc9ee12.js integrity="sha512-UWoWdFvqWpvQERONJUzA/TlzzVXObhXz3sdj58fCx0SPj+e1TMqBHLghsMfhLNFhyqzh3XlKw9NNQJN8vMnuEg=="></script><script defer type=text/javascript id=script-bundle src=/js/main.bundle.min.e4b2d9aece2aa7a740c3ee7a0efc5acf56b204868ab0fb5bba9be32aed1cd0c9262979d98050759068d58144297f74b12ed05b5173cf2df2e6c097a066b984a8.js integrity="sha512-5LLZrs4qp6dAw+56Dvxaz1ayBIaKsPtbupvjKu0c0MkmKXnZgFB1kGjVgUQpf3SxLtBbUXPPLfLmwJegZrmEqA==" data-copy=Copy data-copied=Copied></script><script src=/lib/zoom/zoom.min.umd.a527109b68c082a70f3697716dd72a9d5aa8b545cf800cecbbc7399f2ca6f6e0ce3e431f2062b48bbfa47c9ea42822714060bef309be073f49b9c0e30d318d7b.js integrity="sha512-pScQm2jAgqcPNpdxbdcqnVqotUXPgAzsu8c5nyym9uDOPkMfIGK0i7+kfJ6kKCJxQGC+8wm+Bz9JucDjDTGNew=="></script><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest href=/site.webmanifest><meta property="og:url" content="https://abundance.build/blog/2025-03-17-way-faster-transactions-and-no-panic/"><meta property="og:site_name" content="Project Abundance"><meta property="og:title" content="Way faster transactions and no-panic"><meta property="og:description" content="Performance optimizations for transactions and other improvements"><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="blog"><meta property="article:published_time" content="2025-03-17T00:00:00+00:00"><meta property="article:modified_time" content="2025-03-17T00:00:00+00:00"><meta property="article:tag" content="status-update"><meta name=twitter:card content="summary"><meta name=twitter:title content="Way faster transactions and no-panic"><meta name=twitter:description content="Performance optimizations for transactions and other improvements"><script type=application/ld+json>[{"@context":"https://schema.org","@type":"Article","articleSection":"Blog","name":"Way faster transactions and no-panic","headline":"Way faster transactions and no-panic","description":"Performance optimizations for transactions and other improvements","abstract":"\u003cp\u003eThe plan was to get to transaction pool implementation, but it didn\u0026rsquo;t quite happen. I did a lot of investigation around\nperformance though. For example, transaction processing was several orders of magnitude slower than direct method calls\nwithout a transaction, which concerned me, but after optimizations of last week the difference is ~10x. And it makes\nsense given how much more work the wallet has to do on top of the method call itself.\u003c\/p\u003e","inLanguage":"en","url":"https:\/\/abundance.build\/blog\/2025-03-17-way-faster-transactions-and-no-panic\/","author":{"@type":"Person","name":""},"copyrightYear":"2025","dateCreated":"2025-03-17T00:00:00\u002b00:00","datePublished":"2025-03-17T00:00:00\u002b00:00","dateModified":"2025-03-17T00:00:00\u002b00:00","keywords":["status-update"],"mainEntityOfPage":"true","wordCount":"1447"}]</script><script src=/lib/jquery/jquery.slim.min.b0dca576e87d7eaa5850ae4e61759c065786cdb6489d68fcc82240539eebd5da522bdb4fda085ffd245808c8fe2acb2516408eb774ef26b5f6015fc6737c0ea8.js integrity="sha512-sNylduh9fqpYUK5OYXWcBleGzbZInWj8yCJAU57r1dpSK9tP2ghf/SRYCMj+KsslFkCOt3TvJrX2AV/Gc3wOqA=="></script></head><body class="flex flex-col h-screen px-6 m-auto text-lg leading-7 max-w-7xl bg-neutral text-neutral-900 dark:bg-neutral-800 dark:text-neutral sm:px-14 md:px-24 lg:px-32 scrollbar-thin scrollbar-track-neutral-200 scrollbar-thumb-neutral-400 dark:scrollbar-track-neutral-800 dark:scrollbar-thumb-neutral-600"><div id=the-top class="absolute flex self-center"><a class="px-3 py-1 text-sm -translate-y-8 rounded-b-lg bg-primary-200 focus:translate-y-0 dark:bg-neutral-600" href=#main-content><span class="font-bold text-primary-600 ltr:pr-2 rtl:pl-2 dark:text-primary-400">&darr;</span>
Skip to main content</a></div><div class="main-menu flex items-center justify-between px-4 py-6 sm:px-6 md:justify-start gap-x-3 pt-[2px] pr-0 pb-[3px] pl-0"><div class="flex flex-1 items-center justify-between"><nav class="flex space-x-3"><a href=/ class="text-base font-medium text-gray-500 hover:text-gray-900">Project Abundance</a></nav><nav class="hidden md:flex items-center gap-x-5 md:ml-12 h-12"></nav><div class="flex md:hidden items-center gap-x-5 md:ml-12 h-12"><span></span></div></div><div class="-my-2 md:hidden"><div id=menu-button class=block></div></div></div><div class="relative flex flex-col grow"><main id=main-content class=grow><article><header id=single_header class="mt-5 max-w-prose"><h1 class="mt-0 text-4xl font-extrabold text-neutral-900 dark:text-neutral">Way faster transactions and no-panic</h1><div class="mt-1 mb-6 text-base text-neutral-500 dark:text-neutral-400 print:hidden"><div class="flex flex-row flex-wrap items-center"><time datetime=2025-03-17T00:00:00+00:00>17 March 2025</time><span class="px-2 text-primary-500">&#183;</span><span title="Reading time">7 mins</span><span class="px-2 text-primary-500">&#183;</span>
<span class=mb-[2px]><a href=https://github.com/nazar-pc/abundance/tree/main/website/main/content/blog/2025/2025-03-17-way-faster-transactions-and-no-panic.md class="text-lg hover:text-primary-500" rel="noopener noreferrer" target=_blank title="Edit content"><span class="inline-block align-text-bottom"><span class="relative block icon"><svg height="1em" viewBox="0 0 512 512"><path fill="currentColor" d="M441 58.9 453.1 71c9.4 9.4 9.4 24.6.0 33.9L424 134.1 377.9 88 407 58.9c9.4-9.4 24.6-9.4 33.9.0zM209.8 256.2 344 121.9 390.1 168 255.8 302.2c-2.9 2.9-6.5 5-10.4 6.1L186.9 325l16.7-58.5c1.1-3.9 3.2-7.5 6.1-10.4zM373.1 25 175.8 222.2c-8.7 8.7-15 19.4-18.3 31.1l-28.6 1e2c-2.4 8.4-.1 17.4 6.1 23.6s15.2 8.5 23.6 6.1l1e2-28.6c11.8-3.4 22.5-9.7 31.1-18.3L487 138.9c28.1-28.1 28.1-73.7.0-101.8L474.9 25C446.8-3.1 401.2-3.1 373.1 25zM88 64C39.4 64 0 103.4.0 152V424c0 48.6 39.4 88 88 88H360c48.6.0 88-39.4 88-88V312c0-13.3-10.7-24-24-24s-24 10.7-24 24V424c0 22.1-17.9 40-40 40H88c-22.1.0-40-17.9-40-40V152c0-22.1 17.9-40 40-40H2e2c13.3.0 24-10.7 24-24s-10.7-24-24-24H88z"/></svg></span></span></a></span></div><div class="flex flex-row flex-wrap items-center"><a class="relative mt-[0.5rem] mr-2" href=/tags/status-update/><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">status-update</span></span></a></div></div><div class="flex author"><div class=place-self-center><div class="text-2xl sm:text-lg"></div></div></div><div class="flex author author-extra mt-4"><img class="!mt-0 !mb-0 h-24 w-24 rounded-full ltr:mr-4 rtl:ml-4" width=96 height=96 src=/3d67cc976284fd62356e2edd8a8dfc49_2651210052118205119_hu_2fd6f6eca7f7083d.jpg><div class=place-self-center><div class="text-[0.6rem] uppercase leading-3 text-neutral-500 dark:text-neutral-400">Author</div><a href=https://abundance.build/authors/nazar-pc/ class="font-semibold leading-6 text-neutral-800 dark:text-neutral-300">Nazar Mokrynskyi</a><div class="text-2xl sm:text-lg"><div class="flex flex-wrap text-neutral-400 dark:text-neutral-500"><a class="px-1 hover:text-primary-700 dark:hover:text-primary-400" href=https://linkedin.com/in/nazarpc target=_blank aria-label=Linkedin rel="me noopener noreferrer"><span class="inline-block align-text-bottom"><span class="relative block icon"><svg viewBox="0 0 448 512"><path fill="currentColor" d="M416 32H31.9C14.3 32 0 46.5.0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6.0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3.0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2.0 38.5 17.3 38.5 38.5.0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6.0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2.0 79.7 44.3 79.7 101.9V416z"/></svg>
</span></span></a><a class="px-1 hover:text-primary-700 dark:hover:text-primary-400" href=https://x.com/nazarpc target=_blank aria-label=X-Twitter rel="me noopener noreferrer"><span class="inline-block align-text-bottom"><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentColor" d="M389.2 48h70.6L305.6 224.2 487 464H345L233.7 318.6 106.5 464H35.8L200.7 275.5 26.8 48H172.4L272.9 180.9 389.2 48zM364.4 421.8h39.1L151.1 88h-42L364.4 421.8z"/></svg></span></span></a>
<a class="px-1 hover:text-primary-700 dark:hover:text-primary-400" href=https://github.com/nazar-pc target=_blank aria-label=Github rel="me noopener noreferrer"><span class="inline-block align-text-bottom"><span class="relative block icon"><svg viewBox="0 0 496 512"><path fill="currentColor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6.0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6.0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3.0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1.0-6.2-.3-40.4-.3-61.4.0.0-70 15-84.7-29.8.0.0-11.4-29.1-27.8-36.6.0.0-22.9-15.7 1.6-15.4.0.0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5.0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9.0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4.0 33.7-.3 75.4-.3 83.6.0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6.0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9.0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
</span></span></a><a class="px-1 hover:text-primary-700 dark:hover:text-primary-400" href=mailto:nazar@mokrynskyi.com target=_blank aria-label=Email rel="me noopener noreferrer"><span class="inline-block align-text-bottom"><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentColor" d="M207.8 20.73c-93.45 18.32-168.7 93.66-187 187.1-27.64 140.9 68.65 266.2 199.1 285.1 19.01 2.888 36.17-12.26 36.17-31.49l1e-4-.6631c0-15.74-11.44-28.88-26.84-31.24-84.35-12.98-149.2-86.13-149.2-174.2.0-102.9 88.61-185.5 193.4-175.4 91.54 8.869 158.6 91.25 158.6 183.2v16.16c0 22.09-17.94 40.05-40 40.05s-40.01-17.96-40.01-40.05v-120.1c0-8.847-7.161-16.02-16.01-16.02l-31.98.0036c-7.299.0-13.2 4.992-15.12 11.68-24.85-12.15-54.24-16.38-86.06-5.106-38.75 13.73-68.12 48.91-73.72 89.64-9.483 69.01 43.81 128 110.9 128 26.44.0 50.43-9.544 69.59-24.88 24 31.3 65.23 48.69 109.4 37.49C465.2 369.3 496 324.1 495.1 277.2V256.3c0-149.2-133.9-265.632-287.3-235.57zM239.1 304.3c-26.47.0-48-21.56-48-48.05s21.53-48.05 48-48.05 48 21.56 48 48.05-20.6 48.05-48 48.05z"/></svg></span></span></a></div></div></div></div><div class=mb-5></div></header><section class="flex flex-col max-w-full mt-0 prose dark:prose-invert lg:flex-row"><div class="min-w-0 min-h-0 max-w-fit"><div class="article-content max-w-prose mb-20"><p>The plan was to get to transaction pool implementation, but it didn&rsquo;t quite happen. I did a lot of investigation around
performance though. For example, transaction processing was several orders of magnitude slower than direct method calls
without a transaction, which concerned me, but after optimizations of last week the difference is ~10x. And it makes
sense given how much more work the wallet has to do on top of the method call itself.</p><p>So last week we ended up with ~300 k transaction per second processing rate, while direct method calls were at ~13 M/s
and transaction emulation (bypassing the wallet implementation) was at ~10.8 M/s. But why?</p><p>This turned out to be a combination of things, but the most impactful change was, funnily enough, probably a single
stack-allocated variable that had a size 128x larger than expected. It was documented to be using byte units, but was
actually expressing number of <code>u128</code>s. Decreasing it 128 times helped a lot. There was another data structure that was
also 32 kiB in size, while needing less than one, all that and some more was corrected in <a href=https://github.com/nazar-pc/abundance/pull/120 target=_blank>PR 120</a>.</p><p>That PR also introduced a constant <code>MAX_TOTAL_METHOD_ARGS</code> to define the maximum number of arguments the method can
have. It was not constrained previously, which didn&rsquo;t allow making assumptions about the max size of data structures and
required heap allocations in executor. It is limited to 8, which is the number of bits in a byte and led to much
anticipated rewrite of transaction payload encoding.</p><p>The encoding worked but was a bit less compact than I&rsquo;d like it to be and didn&rsquo;t support using outputs of previous
method calls in the slots of the next one. Now that we know that there couldn&rsquo;t be more than 8 arguments in a method, it
is possible to use very compact bit flags to indicate what kind of value slot or input will use.</p><p><a href=https://github.com/nazar-pc/abundance/pull/121 target=_blank>PR 121</a> implemented the changes and fixed a few bugs. Specifically, it is now possible to create a transaction that in
pseudocode looks like this:</p><pre tabindex=0><code>wallet_address = Code::deploy(wallet_code)
Wallet::initialize(wallet_address, public_key)
Token::send_to(wallet_address, amount)
</code></pre><p>Note that in token transfer <code>wallet_address</code> might be a slot, and that is exactly what wasn&rsquo;t supported previously.
While only a simple sequence of method calls is supported by this reference transaction payload encoding, it already
allows creating interesting workflows. For example, in Ethereum you often use approval in DeFi applications to allow
spending your tokens by a contract. Here it would be possible to allow spending specific number of tokens just for the
duration of the transaction itself:</p><pre tabindex=0><code>Token::allow_transfer_once_by(Context::Reset, contract_addres, amount)
Defi::do_something(Context::Reset)
</code></pre><p>Context wasn&rsquo;t mentioned in examples before for simplicity, but it essentially is a notion similar to a &ldquo;user&rdquo; in
operating systems, defining what things can be accessed. It is possible to inherit the context from a caller, override
it with itself or reset to <code>Address::NULL</code>. Resetting means you don&rsquo;t need to worry much about whatever contract you&rsquo;re
calling. They can&rsquo;t do anything on behalf of the wallet due to context being <code>Address::NULL</code> already. However, by doing
temporary approval, <code>Defi</code> contract gains an ability to do something with <code>Token</code>, but only within the limits of
explicit approval. This is a much nicer security model that is easier to reason about IMO. And since all inputs and
outputs are explicit, there is no danger of contracts messing up with wallet&rsquo;s state by accident.</p><p>Something that <code>Token::allow_transfer_once_by()</code> above would use is <code>#[tmp]</code> argument for ephemeral storage (for
duration of the transaction only), but implementation-wise it is abusing <code>Address::NULL</code> slots, which unfortunately were
not cleaned up properly before. <a href=https://github.com/nazar-pc/abundance/pull/115 target=_blank>PR 115</a> finally extracted <code>Slots</code> data structure along with underlying aligned buffers
into a separate crate, which will be needed for transaction pool implementation and <a href=https://github.com/nazar-pc/abundance/pull/119 target=_blank>PR 119</a> implemented cleanup for
<code>#[tmp]</code> &ldquo;slots&rdquo;.</p><h2 class="relative group">Performance<div id=performance class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#performance aria-label=Anchor>#</a></span></h2><p>With transactions being much faster, I was exploring other kinds of overhead. This time the focus was on compactness and
avoiding heap allocations, with <a href=https://github.com/nazar-pc/abundance/pull/114 target=_blank>PR 114</a>, <a href=https://github.com/nazar-pc/abundance/pull/124 target=_blank>PR 124</a> and <a href=https://github.com/nazar-pc/abundance/pull/125 target=_blank>PR 125</a> performance looks roughly like this:</p><pre tabindex=0><code>flipper/direct          time:   [48.326 ns 48.469 ns 48.638 ns]
                        thrpt:  [20.560 Melem/s 20.632 Melem/s 20.693 Melem/s]
flipper/transaction     time:   [57.682 ns 57.933 ns 58.219 ns]
                        thrpt:  [17.177 Melem/s 17.261 Melem/s 17.336 Melem/s]
example-wallet/execute-only
                        time:   [535.60 ns 537.22 ns 539.44 ns]
                        thrpt:  [1.8538 Melem/s 1.8614 Melem/s 1.8671 Melem/s]
</code></pre><p>A much smaller gap between direct method call and transaction emulation with a massive difference from last week. But
more impressive is increase from ~300 k/s to 1.8 M/s for transactions that can be processed through the whole things,
including the wallet. It is still bottlenecked by the signature verification cost, of course.</p><p>These can and will improve further. For example, metadata decoding is currently happening on every method call, but it
can be cached to remove a significant amount of compute overhead from all benchmarks above.</p><h2 class="relative group">No panic<div id=no-panic class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#no-panic aria-label=Anchor>#</a></span></h2><p>There is an interesting crate in Rust ecosystem called <a href=https://github.com/dtolnay/no-panic target=_blank><code>no-panic</code></a>. What it does is prevent code from compiling unless
the compiler can be convinced that annotated method can&rsquo;t possibly panic. This is a very nice property for assuring
reliability and predictable code behavior. It is a rock-solid compiler guarantee that the API is what it appears to be.
While an error handling story in Rust is already great, the fact that certain things can potentially panic is still
really annoying.</p><p>The way it works is basically inserting a wrapper around user code that instantiates a struct that calls non-existing
function in <code>Drop</code> implementation (that would cause linking error) before user code and removing instance after to
prevent from <code>Drop</code> from actually running. The only way compiler would not eliminate that instance and its <code>Drop</code> it as
dead code is if the user code can panic, in which case the <code>Drop::drop()</code> would need to be called during unwinding.
Brilliant!</p><p>It is tricky to use, but with some effort can be applied to non-const (for now) methods. <a href=https://github.com/nazar-pc/abundance/pull/109 target=_blank>PR 109</a> implemented support
for panic-free payload decoding in <code>ab-system-contract-wallet-base</code> and <a href=https://github.com/nazar-pc/abundance/pull/118 target=_blank>PR 118</a> extended this to a large portion of
<code>ab-contracts-common</code> API. Really looking forward to trait support in <code>const fn</code> in Rust to be able to apply this to
many <code>const fn</code> functions and methods in the codebase. I&rsquo;ll also extend annotations to more crates over time.</p><hr><h2 class="relative group">Documentation<div id=documentation class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#documentation aria-label=Anchor>#</a></span></h2><p>I need to work some more on documentation, and last week I added <a href=/book/Execution_environment/Transactions_overview.html>Transaction overview</a> page to the book with some more
details now that things have settled a bit.</p><h2 class="relative group">ELF<div id=elf class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#elf aria-label=Anchor>#</a></span></h2><p>I&rsquo;ve spent some time researching on what format contracts should be packaged in. I thought about standard ELF rather
than something custom for a long time, but didn&rsquo;t know the specifics. It&rsquo;d be great to use <code>cargo build</code>&rsquo;s output, even
if with custom configuration, without any manual post-processing. I&rsquo;m still not 100% confident that it&rsquo;ll be possible,
but so far it doesn&rsquo;t seem impossible either.</p><p>For a bit of context, what I&rsquo;m ideally looking for is a 64-bit RISC-V ELF file that can be both uploaded to the
blockchain as a contract and used as a &ldquo;shared library&rdquo; of sorts directly. By directly I mean with <code>dlopen()</code> or loading
directly into <code>gdb()</code>, which will be an excellent debugging experience for developers and will eliminate the need to
have custom compilers and debuggers, using industry standard tooling.</p><p>If it works out like I expect, it&rsquo;d be possible to describe a method call in a format close to the pseudocode I have
shown toward the beginning of this post and call it on a contract in <code>gdb</code>/<code>lldb</code>. Even IDE integration should work with
precompiled contracts that way without the need to write special IDE-specific plugins, etc. It&rsquo;ll also hopefully open
the door for hardware acceleration on RISC-V hardware by running contracts in a VM, but I&rsquo;m probably speculating too
much at this point.</p><p>I might start with something simpler and try to upload native x86-64 binaries in the format similar to the eventual
RISC-V binaries, so I can get a feel of it and open them with <code>dlopen()</code> for now.</p><p>I looked into VMs too, with <a href=https://github.com/paritytech/polkavm target=_blank>PolkaVM</a> looking interesting, but requiring PolkaVM-specific sections in ELF, which I&rsquo;d
really prefer to avoid. <a href=https://github.com/embive/embive target=_blank>Embive</a> looked interesting too, but has different design goals, and I&rsquo;m not so sure about its
performance. The impression right now is that either some PolkaVM changes would be needed to integrate it or a separate
interpreter/VM will need to be designed instead.</p><h2 class="relative group">Upcoming plans<div id=upcoming-plans class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#upcoming-plans aria-label=Anchor>#</a></span></h2><p>I&rsquo;d like to get to transaction pool some time this week and to write more docs. There are also some developer interviews
scheduled for later this week, which I hope will provide useful insights.</p><p>I hope you don&rsquo;t regret spending time to read this too much, see you in about a week.</p></div></div><script type=text/javascript src=/js/page.min.54b6f4371722649edbe871e431d8670d670878c22be8f36e229fe53cc9b786fe25a834def5e6de621f7a3e37b72bc8cd73839aa5ed907ed6cbd45cd3e1b0fa20.js integrity="sha512-VLb0NxciZJ7b6HHkMdhnDWcIeMIr6PNuIp/lPMm3hv4lqDTe9ebeYh96Pje3K8jNc4Oape2QftbL1FzT4bD6IA==" data-oid=views_blog/2025/2025-03-17-way-faster-transactions-and-no-panic.md data-oid-likes=likes_blog/2025/2025-03-17-way-faster-transactions-and-no-panic.md></script></section><footer class="pt-8 max-w-prose print:hidden"><div class=pt-8><hr class="border-dotted border-neutral-300 dark:border-neutral-600"><div class="flex justify-between pt-3"><span><a class="flex group mr-3" href=/blog/2025-03-16-drawing-inspiration-from-the-internets-architecture-to-scale-consensus/><span class="mr-3 text-neutral-700 group-hover:text-primary-600 ltr:inline rtl:hidden dark:text-neutral dark:group-hover:text-primary-400">&larr;</span>
<span class="ml-3 text-neutral-700 group-hover:text-primary-600 ltr:hidden rtl:inline dark:text-neutral dark:group-hover:text-primary-400">&rarr;</span>
<span class="flex flex-col"><span class="mt-[0.1rem] leading-6 group-hover:underline group-hover:decoration-primary-500">Drawing inspiration from the Internet's architecture to scale consensus</span>
<span class="mt-[0.1rem] text-xs text-neutral-500 dark:text-neutral-400"><time datetime=2025-03-16T00:00:00+00:00>16 March 2025</time>
</span></span></a></span><span><a class="flex text-right group ml-3" href=/blog/2025-03-24-thinking-formally-in-terms-of-sidechains/><span class="flex flex-col"><span class="mt-[0.1rem] leading-6 group-hover:underline group-hover:decoration-primary-500">Thinking formally in terms of sidechains</span>
<span class="mt-[0.1rem] text-xs text-neutral-500 dark:text-neutral-400"><time datetime=2025-03-24T00:00:00+00:00>24 March 2025</time>
</span></span><span class="ml-3 text-neutral-700 group-hover:text-primary-600 ltr:inline rtl:hidden dark:text-neutral dark:group-hover:text-primary-400">&rarr;</span>
<span class="mr-3 text-neutral-700 group-hover:text-primary-600 ltr:hidden rtl:inline dark:text-neutral dark:group-hover:text-primary-400">&larr;</span></a></span></div></div></footer></article><div id=top-scroller class="pointer-events-none absolute top-[110vh] bottom-0 w-12 ltr:right-0 rtl:left-0 z-10"><a href=#the-top class="pointer-events-auto sticky top-[calc(100vh-5.5rem)] flex h-12 w-12 mb-16 items-center justify-center rounded-full bg-neutral/50 text-xl text-neutral-700 hover:text-primary-600 dark:bg-neutral-800/50 dark:text-neutral dark:hover:text-primary-400" aria-label="Scroll to top" title="Scroll to top">&uarr;</a></div></main><footer id=site-footer class="py-10 print:hidden"><div class="flex items-center justify-between"><p class="text-sm text-neutral-500 dark:text-neutral-400"><a href=https://creativecommons.org/publicdomain/zero/1.0/ target=_blank rel="license noopener noreferrer">CC0 1.0 Universal</a></p><p class="text-xs text-neutral-500 dark:text-neutral-400">Powered by <a class="hover:underline hover:decoration-primary-400 hover:text-primary-500" href=https://gohugo.io/ target=_blank rel="noopener noreferrer">Hugo</a> & <a class="hover:underline hover:decoration-primary-400 hover:text-primary-500" href=https://blowfish.page/ target=_blank rel="noopener noreferrer">Blowfish</a></p></div><script>mediumZoom(document.querySelectorAll("img:not(.nozoom)"),{margin:24,background:"rgba(0,0,0,0.5)",scrollOffset:0})</script><script type=text/javascript src=/js/process.min.ee03488f19c93c2efb199e2e3014ea5f3cb2ce7d45154adb3399a158cac27ca52831db249ede5bb602700ef87eb02434139de0858af1818ab0fb4182472204a4.js integrity="sha512-7gNIjxnJPC77GZ4uMBTqXzyyzn1FFUrbM5mhWMrCfKUoMdsknt5btgJwDvh+sCQ0E53ghYrxgYqw+0GCRyIEpA=="></script></footer></div></body></html>