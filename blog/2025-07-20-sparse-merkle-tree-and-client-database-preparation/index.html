<!doctype html><html lang=en dir=ltr class=scroll-smooth data-default-appearance=dark data-auto-appearance=true><head><meta charset=utf-8><meta http-equiv=content-language content="en"><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=X-UA-Compatible content="ie=edge"><meta name=theme-color><title>Sparse Merkle Tree and client database preparation &#183; Project Abundance</title><meta name=title content="Sparse Merkle Tree and client database preparation &#183; Project Abundance"><meta name=description content="While the client database implementation is not ready yet, I managed to implement a few underlying components."><meta name=keywords content="status-update,"><link rel=canonical href=https://abundance.build/blog/2025-07-20-sparse-merkle-tree-and-client-database-preparation/><link type=text/css rel=stylesheet href=/css/main.bundle.min.fd951ea54edeca1b6b08c8bbf3c93c284de4c78daf63a71d8016939775734cf68700f1662ed31d870100c676cbe1f65d150635cf368b874c49fc75147bcb04a9.css integrity="sha512-/ZUepU7eyhtrCMi788k8KE3kx42vY6cdgBaTl3VzTPaHAPFmLtMdhwEAxnbL4fZdFQY1zzaLh0xJ/HUUe8sEqQ=="><script type=text/javascript src=/js/appearance.min.516a16745bea5a9bd011138d254cc0fd3973cd55ce6e15f3dec763e7c7c2c7448f8fe7b54cca811cb821b0c7e12cd161caace1dd794ac3d34d40937cbcc9ee12.js integrity="sha512-UWoWdFvqWpvQERONJUzA/TlzzVXObhXz3sdj58fCx0SPj+e1TMqBHLghsMfhLNFhyqzh3XlKw9NNQJN8vMnuEg=="></script><script defer type=text/javascript id=script-bundle src=/js/main.bundle.min.e4b2d9aece2aa7a740c3ee7a0efc5acf56b204868ab0fb5bba9be32aed1cd0c9262979d98050759068d58144297f74b12ed05b5173cf2df2e6c097a066b984a8.js integrity="sha512-5LLZrs4qp6dAw+56Dvxaz1ayBIaKsPtbupvjKu0c0MkmKXnZgFB1kGjVgUQpf3SxLtBbUXPPLfLmwJegZrmEqA==" data-copy=Copy data-copied=Copied></script><script src=/lib/zoom/zoom.min.umd.a527109b68c082a70f3697716dd72a9d5aa8b545cf800cecbbc7399f2ca6f6e0ce3e431f2062b48bbfa47c9ea42822714060bef309be073f49b9c0e30d318d7b.js integrity="sha512-pScQm2jAgqcPNpdxbdcqnVqotUXPgAzsu8c5nyym9uDOPkMfIGK0i7+kfJ6kKCJxQGC+8wm+Bz9JucDjDTGNew=="></script><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest href=/site.webmanifest><meta property="og:url" content="https://abundance.build/blog/2025-07-20-sparse-merkle-tree-and-client-database-preparation/"><meta property="og:site_name" content="Project Abundance"><meta property="og:title" content="Sparse Merkle Tree and client database preparation"><meta property="og:description" content="While the client database implementation is not ready yet, I managed to implement a few underlying components."><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="blog"><meta property="article:published_time" content="2025-07-20T00:00:00+00:00"><meta property="article:modified_time" content="2025-07-20T00:00:00+00:00"><meta property="article:tag" content="status-update"><meta name=twitter:card content="summary"><meta name=twitter:title content="Sparse Merkle Tree and client database preparation"><meta name=twitter:description content="While the client database implementation is not ready yet, I managed to implement a few underlying components."><script type=application/ld+json>[{"@context":"https://schema.org","@type":"Article","articleSection":"Blog","name":"Sparse Merkle Tree and client database preparation","headline":"Sparse Merkle Tree and client database preparation","description":"While the client database implementation is not ready yet, I managed to implement a few underlying components.","abstract":"\u003cp\u003eAfter adventures with rust-gpu, which I still monitor periodically, I moved on to the client database implementation,\nwhich is required for proper blockchain operation, and which is one of the bigger undertakings. Unfortunately, the\ndatabase as such isn\u0026rsquo;t quite ready yet, but I did some preparation and would like to share some details about the\ndatabase architecture.\u003c\/p\u003e","inLanguage":"en","url":"https:\/\/abundance.build\/blog\/2025-07-20-sparse-merkle-tree-and-client-database-preparation\/","author":{"@type":"Person","name":""},"copyrightYear":"2025","dateCreated":"2025-07-20T00:00:00\u002b00:00","datePublished":"2025-07-20T00:00:00\u002b00:00","dateModified":"2025-07-20T00:00:00\u002b00:00","keywords":["status-update"],"mainEntityOfPage":"true","wordCount":"1567"}]</script><script src=/lib/jquery/jquery.slim.min.b0dca576e87d7eaa5850ae4e61759c065786cdb6489d68fcc82240539eebd5da522bdb4fda085ffd245808c8fe2acb2516408eb774ef26b5f6015fc6737c0ea8.js integrity="sha512-sNylduh9fqpYUK5OYXWcBleGzbZInWj8yCJAU57r1dpSK9tP2ghf/SRYCMj+KsslFkCOt3TvJrX2AV/Gc3wOqA=="></script></head><body class="flex flex-col h-screen px-6 m-auto text-lg leading-7 max-w-7xl bg-neutral text-neutral-900 dark:bg-neutral-800 dark:text-neutral sm:px-14 md:px-24 lg:px-32 scrollbar-thin scrollbar-track-neutral-200 scrollbar-thumb-neutral-400 dark:scrollbar-track-neutral-800 dark:scrollbar-thumb-neutral-600"><div id=the-top class="absolute flex self-center"><a class="px-3 py-1 text-sm -translate-y-8 rounded-b-lg bg-primary-200 focus:translate-y-0 dark:bg-neutral-600" href=#main-content><span class="font-bold text-primary-600 ltr:pr-2 rtl:pl-2 dark:text-primary-400">&darr;</span>
Skip to main content</a></div><div class="main-menu flex items-center justify-between px-4 py-6 sm:px-6 md:justify-start gap-x-3 pt-[2px] pr-0 pb-[3px] pl-0"><div class="flex flex-1 items-center justify-between"><nav class="flex space-x-3"><a href=/ class="text-base font-medium text-gray-500 hover:text-gray-900">Project Abundance</a></nav><nav class="hidden md:flex items-center gap-x-5 md:ml-12 h-12"></nav><div class="flex md:hidden items-center gap-x-5 md:ml-12 h-12"><span></span></div></div><div class="-my-2 md:hidden"><div id=menu-button class=block></div></div></div><div class="relative flex flex-col grow"><main id=main-content class=grow><article><header id=single_header class="mt-5 max-w-prose"><h1 class="mt-0 text-4xl font-extrabold text-neutral-900 dark:text-neutral">Sparse Merkle Tree and client database preparation</h1><div class="mt-1 mb-6 text-base text-neutral-500 dark:text-neutral-400 print:hidden"><div class="flex flex-row flex-wrap items-center"><time datetime=2025-07-20T00:00:00+00:00>20 July 2025</time><span class="px-2 text-primary-500">&#183;</span><span title="Reading time">8 mins</span><span class="px-2 text-primary-500">&#183;</span>
<span class=mb-[2px]><a href=https://github.com/nazar-pc/abundance/tree/main/website/main/content/blog/2025-07-20-sparse-merkle-tree-and-client-database-preparation.md class="text-lg hover:text-primary-500" rel="noopener noreferrer" target=_blank title="Edit content"><span class="inline-block align-text-bottom"><span class="relative block icon"><svg height="1em" viewBox="0 0 512 512"><path fill="currentColor" d="M441 58.9 453.1 71c9.4 9.4 9.4 24.6.0 33.9L424 134.1 377.9 88 407 58.9c9.4-9.4 24.6-9.4 33.9.0zM209.8 256.2 344 121.9 390.1 168 255.8 302.2c-2.9 2.9-6.5 5-10.4 6.1L186.9 325l16.7-58.5c1.1-3.9 3.2-7.5 6.1-10.4zM373.1 25 175.8 222.2c-8.7 8.7-15 19.4-18.3 31.1l-28.6 1e2c-2.4 8.4-.1 17.4 6.1 23.6s15.2 8.5 23.6 6.1l1e2-28.6c11.8-3.4 22.5-9.7 31.1-18.3L487 138.9c28.1-28.1 28.1-73.7.0-101.8L474.9 25C446.8-3.1 401.2-3.1 373.1 25zM88 64C39.4 64 0 103.4.0 152V424c0 48.6 39.4 88 88 88H360c48.6.0 88-39.4 88-88V312c0-13.3-10.7-24-24-24s-24 10.7-24 24V424c0 22.1-17.9 40-40 40H88c-22.1.0-40-17.9-40-40V152c0-22.1 17.9-40 40-40H2e2c13.3.0 24-10.7 24-24s-10.7-24-24-24H88z"/></svg></span></span></a></span></div><div class="flex flex-row flex-wrap items-center"><a class="relative mt-[0.5rem] mr-2" href=/tags/status-update/><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">status-update</span></span></a></div></div><div class="flex author"><div class=place-self-center><div class="text-2xl sm:text-lg"></div></div></div><div class="flex author author-extra mt-4"><img class="!mt-0 !mb-0 h-24 w-24 rounded-full ltr:mr-4 rtl:ml-4" width=96 height=96 src=/3d67cc976284fd62356e2edd8a8dfc49_2651210052118205119_hu_2fd6f6eca7f7083d.jpg><div class=place-self-center><div class="text-[0.6rem] uppercase leading-3 text-neutral-500 dark:text-neutral-400">Author</div><a href=https://abundance.build/authors/nazar-pc/ class="font-semibold leading-6 text-neutral-800 dark:text-neutral-300">Nazar Mokrynskyi</a><div class="text-2xl sm:text-lg"><div class="flex flex-wrap text-neutral-400 dark:text-neutral-500"><a class="px-1 hover:text-primary-700 dark:hover:text-primary-400" href=https://linkedin.com/in/nazarpc target=_blank aria-label=Linkedin rel="me noopener noreferrer"><span class="inline-block align-text-bottom"><span class="relative block icon"><svg viewBox="0 0 448 512"><path fill="currentColor" d="M416 32H31.9C14.3 32 0 46.5.0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6.0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3.0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2.0 38.5 17.3 38.5 38.5.0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6.0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2.0 79.7 44.3 79.7 101.9V416z"/></svg>
</span></span></a><a class="px-1 hover:text-primary-700 dark:hover:text-primary-400" href=https://x.com/nazarpc target=_blank aria-label=X-Twitter rel="me noopener noreferrer"><span class="inline-block align-text-bottom"><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentColor" d="M389.2 48h70.6L305.6 224.2 487 464H345L233.7 318.6 106.5 464H35.8L200.7 275.5 26.8 48H172.4L272.9 180.9 389.2 48zM364.4 421.8h39.1L151.1 88h-42L364.4 421.8z"/></svg></span></span></a>
<a class="px-1 hover:text-primary-700 dark:hover:text-primary-400" href=https://github.com/nazar-pc target=_blank aria-label=Github rel="me noopener noreferrer"><span class="inline-block align-text-bottom"><span class="relative block icon"><svg viewBox="0 0 496 512"><path fill="currentColor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6.0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6.0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3.0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1.0-6.2-.3-40.4-.3-61.4.0.0-70 15-84.7-29.8.0.0-11.4-29.1-27.8-36.6.0.0-22.9-15.7 1.6-15.4.0.0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5.0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9.0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4.0 33.7-.3 75.4-.3 83.6.0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6.0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9.0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
</span></span></a><a class="px-1 hover:text-primary-700 dark:hover:text-primary-400" href=mailto:nazar@mokrynskyi.com target=_blank aria-label=Email rel="me noopener noreferrer"><span class="inline-block align-text-bottom"><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentColor" d="M207.8 20.73c-93.45 18.32-168.7 93.66-187 187.1-27.64 140.9 68.65 266.2 199.1 285.1 19.01 2.888 36.17-12.26 36.17-31.49l1e-4-.6631c0-15.74-11.44-28.88-26.84-31.24-84.35-12.98-149.2-86.13-149.2-174.2.0-102.9 88.61-185.5 193.4-175.4 91.54 8.869 158.6 91.25 158.6 183.2v16.16c0 22.09-17.94 40.05-40 40.05s-40.01-17.96-40.01-40.05v-120.1c0-8.847-7.161-16.02-16.01-16.02l-31.98.0036c-7.299.0-13.2 4.992-15.12 11.68-24.85-12.15-54.24-16.38-86.06-5.106-38.75 13.73-68.12 48.91-73.72 89.64-9.483 69.01 43.81 128 110.9 128 26.44.0 50.43-9.544 69.59-24.88 24 31.3 65.23 48.69 109.4 37.49C465.2 369.3 496 324.1 495.1 277.2V256.3c0-149.2-133.9-265.632-287.3-235.57zM239.1 304.3c-26.47.0-48-21.56-48-48.05s21.53-48.05 48-48.05 48 21.56 48 48.05-20.6 48.05-48 48.05z"/></svg></span></span></a></div></div></div></div><div class=mb-5></div></header><section class="flex flex-col max-w-full mt-0 prose dark:prose-invert lg:flex-row"><div class="min-w-0 min-h-0 max-w-fit"><div class="article-content max-w-prose mb-20"><p>After adventures with rust-gpu, which I still monitor periodically, I moved on to the client database implementation,
which is required for proper blockchain operation, and which is one of the bigger undertakings. Unfortunately, the
database as such isn&rsquo;t quite ready yet, but I did some preparation and would like to share some details about the
database architecture.</p><h2 class="relative group">Sparse Merkle Tree<div id=sparse-merkle-tree class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#sparse-merkle-tree aria-label=Anchor>#</a></span></h2><p>The blockchain state is expected to be organized as a Sparse Merkle Tree, but just like with regular Merkle Tree, none
of the implementations on crates.io looked like a good fit. With that, I decided to implement my own and merged it in
<a href=https://github.com/nazar-pc/abundance/pull/328 target=_blank>PR 328</a>.</p><p>The implementation is quite specific to the use case at hand. For example, it currently only supports up to \(2^128\)
leaves since this is how many addresses the blockchain supports. It is not quite as efficient as it could be since it
hashes one pair of leaves at a time, but it already includes an efficient handling of empty/missing leaves. The
improvements in this department will come later, just like Merkle Tree will become much faster with <a href=https://github.com/BLAKE3-team/BLAKE3/issues/478 target=_blank>SIMD-accelerated</a>
hashing of multiple values. In fact, unofficial <code>blake3::platform</code> APIs already make it possible, which I plan to take
advantage of before something like that is upstreamed.</p><p>Architecturally, Sparse Merkle Tree implementation is very close to the Merkle Tree implementation that already existed,
but it &ldquo;hashes&rdquo; two zero-filled nodes into a zero-filled node, which allows optimizing proof size. Other than that it is
still a recursive data structure, and larger trees can be built from a set of smaller ones.</p><p>Implementations I found on crates.io are tied to the storage backend, while what I implemented is basically ephemeral.
It just takes an iterator with leaves and an input and produces a root as an output. It is expected that a bunch of
smaller subtrees will be stored on disk and re-hashing will only need to be done on small parts of it, while
higher-level nodes will be retained in memory. Since an optimized BLAKE3 implementation can hash ~9 GB of data on a
single CPU core on my machine, a small in-memory cache will go a long way.</p><h2 class="relative group">Direct file I/O<div id=direct-file-io class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#direct-file-io aria-label=Anchor>#</a></span></h2><p>I learned the hard way while working on the Subspace farmer that the way OSs handle file I/O is quite inefficient when
you know exactly what you&rsquo;re doing. Application-level caching is much more effective and efficient, that is assuming it
is necessary at all. The code for direct I/O was hidden in the farmer implementation. However, now that I want to reuse
it for database implementation, I extracted it into <code>ab-direct-io-file</code> crate in <a href=https://github.com/nazar-pc/abundance/pull/332 target=_blank>PR 332</a>, then in <a href=https://github.com/nazar-pc/abundance/pull/333 target=_blank>PR 333</a> farmer
started to use it instead of its own copy.</p><p>The implementation should work for now, but eventually I&rsquo;d like to get back to experiments with async I/O using
<code>io_uring</code>, which I tried in the past already, but it didn&rsquo;t perform particularly well. With what I know now, I think it
may have been caused by the fact that back then I was not doing direct I/O, so OS interference had a large impact.</p><h2 class="relative group">Client database<div id=client-database class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#client-database aria-label=Anchor>#</a></span></h2><p>Those are both components that will be used for/in conjunction with the client database. The database is not in a state
to open a PR and is not usable yet, but I can share some ideas and design decisions in the meantime.</p><p>As I mentioned in <a href=../2025-04-26-blockchain-as-a-library>Blockchain as a library</a>, the reference implementation of a node will only support block authoring by
default, which opens a design space for optimizations.</p><p>I&rsquo;d really like to achieve constant-size disk usage just like on the farmer: node will pre-allocate all the necessary
space upfront and only use that in the runtime.</p><p>Another observation is that while the blockchain does have short-term natural forks, most of them are short-lived, so
those that didn&rsquo;t survive for long don&rsquo;t need to be written to disk at all.</p><p>Yet another important feature is that the blocks at 100 blocks deep are immutable, and even beyond that there is a
limited number of blocks that need to be stored. So the blocks don&rsquo;t need to be written into a fancy database, a flat
file is just fine. Due to limited overall size, the file can be scanned on startup and mapping from blocks to offsets
can be maintained in memory. In fact blocks in memory can also be stored in a flat list, only a single map from a block
hash to an offset into an in-memory list needs to be stored. This all means very compact and efficient data structures
both in memory and on disk.</p><p>Now there is a bit of a challenge with state. It is both larger than blocks, and it is stored permanently. Thankfully,
due to only storing roots of individual accounts rather than the contents of the state as such, the total amount of disk
space used will be incomparably smaller than in more traditional blockchains. So much so that for early stages of the
network, it&rsquo;ll likely all easily fit into in-memory cache, but we still need to prepare for it to grow over time.</p><p>The way I&rsquo;m thinking to approach it is to essentially start with an empty Sparse Merkle Tree, represented by a simple
flat list of leaves, which can be hashed together to get a state root. On updates, a new list can be written to disk.
Writes to SSDs happen in pages anyway, so anything smaller than 4 kiB (on modern SSDs more like 16 kiB) ends up
consuming the whole page of actual disk write resource anyway. Once the list becomes too large, we split it in half by
the key space until it fits into a single page again.</p><p>This can be done recursively over time as the state gets bigger, possibly with some &ldquo;incremental diff&rdquo; stored for most
blocks on top of earlier checkpoint to trade disk space for computation. In-memory representation will likely store the
most information about the state of the best block, since that is the one, which will be accessed most often. Remember,
this is a block authoring node, not RPC, so we care very little about older state and don&rsquo;t need it in most cases, and
it is fine to pay a bit extra for its access.</p><p>In-memory cache will store references to these pages with some number of caches roots of subtrees of the larger state
Sparse Merkle Tree, so the final root can be derived quickly without hashing the whole thing.</p><p>Both blocks and state subtrees and other elements are expected to be stored in a single flat file as &ldquo;storage items.&rdquo;
Each storage item will be aligned to the disk page size for efficient access. Writes will be done in full pages, storage
items will be cleared in bulk, and notification will be sent to the SSD that the pages are no longer used.</p><p>To handle interrupted disk writes, a few checksums will be added on storage item: one for header and one for the
contents. The checksum for the header will be stored twice, once at the beginning of the storage item and once at the
end. This should cover the most likely case of incomplete write where the tail of the storage item is missing.</p><p>Storage items will also not be allowed to cross certain boundaries, like every multiple of 1 GiB. which will allow to
quickly and efficiently scan the whole file and read its contents with high level of concurrency since read can start at
any boundary and be guaranteed to hit the beginning of a storage item.</p><p>Overall this should result in a flat file with a simple structure, next to no write amplification and O(1) reads for
most practical purposes. This can only be done with a specific use case in mind and only due to architectural decisions
around smart contracts design done earlier.</p><h2 class="relative group">Upcoming plans<div id=upcoming-plans class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#upcoming-plans aria-label=Anchor>#</a></span></h2><p>I delayed this update a bit because I wanted to have some early version of the database working first. But it takes a
substantial amount of time and I spent way too much time thinking and researching before I could even write anything.
There was some amount of procrastination involved, of course. But I think the description should give you an idea of
what it will look like, and hopefully it&rsquo;ll not take too much time to have something to show as well.</p><p>My plan for the next few weeks is to continue working on the client database. I might make another detour to implement
SIMD-accelerated BLAKE3 hashing for Merkle Tree (probably just balanced to start) and Sparse Merkle Tree to see how
close it can get to the theoretical limits with current design that uses iterators, etc. Also once <a href=https://github.com/Rust-GPU/rust-gpu/pull/317 target=_blank>const folding PR</a> is
merged into rust-gpu, I&rsquo;ll likely jump back and merge at least <a href=https://subspace.github.io/protocol-specs/docs/consensus/proof_of_space#compute_fn target=_blank>compute_fn()</a> implementation, which I already
implemented earlier (except tests).</p><p>I was also thinking about publishing some of the libraries like <code>ab-blake3</code> and <code>ab-direct-io-file</code> to crates.io since I
do believe they might be useful to others and there isn&rsquo;t really any library currently published that does what those
libraries do.</p><p>Still a lot of work in different areas, so I&rsquo;ll certainly not being blocked completely by anything except myself. If any
of this was interesting, and you&rsquo;d like to discuss it, ping me on <a href=https://abundance.zulipchat.com/ target=_blank>Zulip</a>. Otherwise, I&rsquo;ll have another update in a week
or so.</p></div></div><script type=text/javascript src=/js/page.min.54b6f4371722649edbe871e431d8670d670878c22be8f36e229fe53cc9b786fe25a834def5e6de621f7a3e37b72bc8cd73839aa5ed907ed6cbd45cd3e1b0fa20.js integrity="sha512-VLb0NxciZJ7b6HHkMdhnDWcIeMIr6PNuIp/lPMm3hv4lqDTe9ebeYh96Pje3K8jNc4Oape2QftbL1FzT4bD6IA==" data-oid=views_blog/2025-07-20-sparse-merkle-tree-and-client-database-preparation.md data-oid-likes=likes_blog/2025-07-20-sparse-merkle-tree-and-client-database-preparation.md></script></section><footer class="pt-8 max-w-prose print:hidden"><div class=pt-8><hr class="border-dotted border-neutral-300 dark:border-neutral-600"><div class="flex justify-between pt-3"><span><a class="flex group mr-3" href=/blog/2025-07-14-a-deterministic-mapping-for-plot-lifecycle-management/><span class="mr-3 text-neutral-700 group-hover:text-primary-600 ltr:inline rtl:hidden dark:text-neutral dark:group-hover:text-primary-400">&larr;</span>
<span class="ml-3 text-neutral-700 group-hover:text-primary-600 ltr:hidden rtl:inline dark:text-neutral dark:group-hover:text-primary-400">&rarr;</span>
<span class="flex flex-col"><span class="mt-[0.1rem] leading-6 group-hover:underline group-hover:decoration-primary-500">A Deterministic Mapping for Plot Lifecycle Management</span>
<span class="mt-[0.1rem] text-xs text-neutral-500 dark:text-neutral-400"><time datetime=2025-07-14T00:00:00+00:00>14 July 2025</time>
</span></span></a></span><span><a class="flex text-right group ml-3" href=/blog/2025-08-01-client-database-prototype/><span class="flex flex-col"><span class="mt-[0.1rem] leading-6 group-hover:underline group-hover:decoration-primary-500">Client database prototype</span>
<span class="mt-[0.1rem] text-xs text-neutral-500 dark:text-neutral-400"><time datetime=2025-08-01T00:00:00+00:00>1 August 2025</time>
</span></span><span class="ml-3 text-neutral-700 group-hover:text-primary-600 ltr:inline rtl:hidden dark:text-neutral dark:group-hover:text-primary-400">&rarr;</span>
<span class="mr-3 text-neutral-700 group-hover:text-primary-600 ltr:hidden rtl:inline dark:text-neutral dark:group-hover:text-primary-400">&larr;</span></a></span></div></div></footer></article><div id=top-scroller class="pointer-events-none absolute top-[110vh] bottom-0 w-12 ltr:right-0 rtl:left-0 z-10"><a href=#the-top class="pointer-events-auto sticky top-[calc(100vh-5.5rem)] flex h-12 w-12 mb-16 items-center justify-center rounded-full bg-neutral/50 text-xl text-neutral-700 hover:text-primary-600 dark:bg-neutral-800/50 dark:text-neutral dark:hover:text-primary-400" aria-label="Scroll to top" title="Scroll to top">&uarr;</a></div></main><footer id=site-footer class="py-10 print:hidden"><div class="flex items-center justify-between"><p class="text-sm text-neutral-500 dark:text-neutral-400"><a href=https://creativecommons.org/publicdomain/zero/1.0/ target=_blank rel="license noopener noreferrer">CC0 1.0 Universal</a></p><p class="text-xs text-neutral-500 dark:text-neutral-400">Powered by <a class="hover:underline hover:decoration-primary-400 hover:text-primary-500" href=https://gohugo.io/ target=_blank rel="noopener noreferrer">Hugo</a> & <a class="hover:underline hover:decoration-primary-400 hover:text-primary-500" href=https://blowfish.page/ target=_blank rel="noopener noreferrer">Blowfish</a></p></div><script>mediumZoom(document.querySelectorAll("img:not(.nozoom)"),{margin:24,background:"rgba(0,0,0,0.5)",scrollOffset:0})</script><script type=text/javascript src=/js/process.min.ee03488f19c93c2efb199e2e3014ea5f3cb2ce7d45154adb3399a158cac27ca52831db249ede5bb602700ef87eb02434139de0858af1818ab0fb4182472204a4.js integrity="sha512-7gNIjxnJPC77GZ4uMBTqXzyyzn1FFUrbM5mhWMrCfKUoMdsknt5btgJwDvh+sCQ0E53ghYrxgYqw+0GCRyIEpA=="></script></footer></div></body></html>