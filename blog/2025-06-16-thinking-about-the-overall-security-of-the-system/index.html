<!doctype html><html lang=en dir=ltr class=scroll-smooth data-default-appearance=dark data-auto-appearance=true><head><meta charset=utf-8><meta http-equiv=content-language content="en"><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=X-UA-Compatible content="ie=edge"><meta name=theme-color><title>Thinking about the overall security of the system &#183; Project Abundance</title><meta name=title content="Thinking about the overall security of the system &#183; Project Abundance"><meta name=description content="Identifying any existential risks to the system and how to mitigate them."><meta name=keywords content="status-update,consensus,"><link rel=canonical href=https://abundance.build/blog/2025-06-16-thinking-about-the-overall-security-of-the-system/><link type=text/css rel=stylesheet href=/css/main.bundle.min.fd951ea54edeca1b6b08c8bbf3c93c284de4c78daf63a71d8016939775734cf68700f1662ed31d870100c676cbe1f65d150635cf368b874c49fc75147bcb04a9.css integrity="sha512-/ZUepU7eyhtrCMi788k8KE3kx42vY6cdgBaTl3VzTPaHAPFmLtMdhwEAxnbL4fZdFQY1zzaLh0xJ/HUUe8sEqQ=="><script type=text/javascript src=/js/appearance.min.516a16745bea5a9bd011138d254cc0fd3973cd55ce6e15f3dec763e7c7c2c7448f8fe7b54cca811cb821b0c7e12cd161caace1dd794ac3d34d40937cbcc9ee12.js integrity="sha512-UWoWdFvqWpvQERONJUzA/TlzzVXObhXz3sdj58fCx0SPj+e1TMqBHLghsMfhLNFhyqzh3XlKw9NNQJN8vMnuEg=="></script><script defer type=text/javascript id=script-bundle src=/js/main.bundle.min.e4b2d9aece2aa7a740c3ee7a0efc5acf56b204868ab0fb5bba9be32aed1cd0c9262979d98050759068d58144297f74b12ed05b5173cf2df2e6c097a066b984a8.js integrity="sha512-5LLZrs4qp6dAw+56Dvxaz1ayBIaKsPtbupvjKu0c0MkmKXnZgFB1kGjVgUQpf3SxLtBbUXPPLfLmwJegZrmEqA==" data-copy=Copy data-copied=Copied></script><script src=/lib/zoom/zoom.min.umd.a527109b68c082a70f3697716dd72a9d5aa8b545cf800cecbbc7399f2ca6f6e0ce3e431f2062b48bbfa47c9ea42822714060bef309be073f49b9c0e30d318d7b.js integrity="sha512-pScQm2jAgqcPNpdxbdcqnVqotUXPgAzsu8c5nyym9uDOPkMfIGK0i7+kfJ6kKCJxQGC+8wm+Bz9JucDjDTGNew=="></script><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest href=/site.webmanifest><meta property="og:url" content="https://abundance.build/blog/2025-06-16-thinking-about-the-overall-security-of-the-system/"><meta property="og:site_name" content="Project Abundance"><meta property="og:title" content="Thinking about the overall security of the system"><meta property="og:description" content="Identifying any existential risks to the system and how to mitigate them."><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="blog"><meta property="article:published_time" content="2025-06-16T00:00:00+00:00"><meta property="article:modified_time" content="2025-06-16T00:00:00+00:00"><meta property="article:tag" content="status-update"><meta property="article:tag" content="consensus"><meta name=twitter:card content="summary"><meta name=twitter:title content="Thinking about the overall security of the system"><meta name=twitter:description content="Identifying any existential risks to the system and how to mitigate them."><script type=application/ld+json>[{"@context":"https://schema.org","@type":"Article","articleSection":"Blog","name":"Thinking about the overall security of the system","headline":"Thinking about the overall security of the system","description":"Identifying any existential risks to the system and how to mitigate them.","abstract":"\u003cp\u003eThis week has been all about objectively assessing the security of the system. After all of the work\naround the membership allocation protocol and its security there are still two questions that we\nneed to answer to understand the feasibility of the protocol: (i) what is the security bound of the\nprotocol as a whole (from beacon chain to shards), and (ii) how can we ensure that plots are\nuniquely identified and that farmers cannot cheat by committing the same plot to different history\nsizes to try and game the shard allocation mechanism.\u003c\/p\u003e","inLanguage":"en","url":"https:\/\/abundance.build\/blog\/2025-06-16-thinking-about-the-overall-security-of-the-system\/","author":{"@type":"Person","name":""},"copyrightYear":"2025","dateCreated":"2025-06-16T00:00:00\u002b00:00","datePublished":"2025-06-16T00:00:00\u002b00:00","dateModified":"2025-06-16T00:00:00\u002b00:00","keywords":["status-update","consensus"],"mainEntityOfPage":"true","wordCount":"2198"}]</script><script src=/lib/jquery/jquery.slim.min.b0dca576e87d7eaa5850ae4e61759c065786cdb6489d68fcc82240539eebd5da522bdb4fda085ffd245808c8fe2acb2516408eb774ef26b5f6015fc6737c0ea8.js integrity="sha512-sNylduh9fqpYUK5OYXWcBleGzbZInWj8yCJAU57r1dpSK9tP2ghf/SRYCMj+KsslFkCOt3TvJrX2AV/Gc3wOqA=="></script><link type=text/css rel=stylesheet href=/lib/katex/katex.min.7e7e35e3ef02b7b437449a44ca3fac62ec1ed39cb8312b680a00fe8ac60badc95b063b694636b8440856f7f5e8c2cc9e6b0efb581179b2656c7e1e97558c7096.css integrity="sha512-fn414+8Ct7Q3RJpEyj+sYuwe05y4MStoCgD+isYLrclbBjtpRja4RAhW9/Xowsyeaw77WBF5smVsfh6XVYxwlg=="><script defer type=text/javascript src=/js/katex.bundle.735b6f1542c0acf03d492dcdf14710c2e277474a64ae8ce49ef56563e17d142f9d3f4466e82cf12679968f50985628e08948ec341fba2df746545d0fd337d81d.js integrity="sha512-c1tvFULArPA9SS3N8UcQwuJ3R0pkrozknvVlY+F9FC+dP0Rm6CzxJnmWj1CYVijgiUjsNB+6LfdGVF0P0zfYHQ==" id=katex-render></script></head><body class="flex flex-col h-screen px-6 m-auto text-lg leading-7 max-w-7xl bg-neutral text-neutral-900 dark:bg-neutral-800 dark:text-neutral sm:px-14 md:px-24 lg:px-32 scrollbar-thin scrollbar-track-neutral-200 scrollbar-thumb-neutral-400 dark:scrollbar-track-neutral-800 dark:scrollbar-thumb-neutral-600"><div id=the-top class="absolute flex self-center"><a class="px-3 py-1 text-sm -translate-y-8 rounded-b-lg bg-primary-200 focus:translate-y-0 dark:bg-neutral-600" href=#main-content><span class="font-bold text-primary-600 ltr:pr-2 rtl:pl-2 dark:text-primary-400">&darr;</span>
Skip to main content</a></div><div class="main-menu flex items-center justify-between px-4 py-6 sm:px-6 md:justify-start gap-x-3 pt-[2px] pr-0 pb-[3px] pl-0"><div class="flex flex-1 items-center justify-between"><nav class="flex space-x-3"><a href=/ class="text-base font-medium text-gray-500 hover:text-gray-900">Project Abundance</a></nav><nav class="hidden md:flex items-center gap-x-5 md:ml-12 h-12"></nav><div class="flex md:hidden items-center gap-x-5 md:ml-12 h-12"><span></span></div></div><div class="-my-2 md:hidden"><div id=menu-button class=block></div></div></div><div class="relative flex flex-col grow"><main id=main-content class=grow><article><header id=single_header class="mt-5 max-w-prose"><h1 class="mt-0 text-4xl font-extrabold text-neutral-900 dark:text-neutral">Thinking about the overall security of the system</h1><div class="mt-1 mb-6 text-base text-neutral-500 dark:text-neutral-400 print:hidden"><div class="flex flex-row flex-wrap items-center"><time datetime=2025-06-16T00:00:00+00:00>16 June 2025</time><span class="px-2 text-primary-500">&#183;</span><span title="Reading time">11 mins</span><span class="px-2 text-primary-500">&#183;</span>
<span class=mb-[2px]><a href=https://github.com/nazar-pc/abundance/tree/main/website/main/content/blog/2025-06-16-thinking-about-security.md class="text-lg hover:text-primary-500" rel="noopener noreferrer" target=_blank title="Edit content"><span class="inline-block align-text-bottom"><span class="relative block icon"><svg height="1em" viewBox="0 0 512 512"><path fill="currentColor" d="M441 58.9 453.1 71c9.4 9.4 9.4 24.6.0 33.9L424 134.1 377.9 88 407 58.9c9.4-9.4 24.6-9.4 33.9.0zM209.8 256.2 344 121.9 390.1 168 255.8 302.2c-2.9 2.9-6.5 5-10.4 6.1L186.9 325l16.7-58.5c1.1-3.9 3.2-7.5 6.1-10.4zM373.1 25 175.8 222.2c-8.7 8.7-15 19.4-18.3 31.1l-28.6 1e2c-2.4 8.4-.1 17.4 6.1 23.6s15.2 8.5 23.6 6.1l1e2-28.6c11.8-3.4 22.5-9.7 31.1-18.3L487 138.9c28.1-28.1 28.1-73.7.0-101.8L474.9 25C446.8-3.1 401.2-3.1 373.1 25zM88 64C39.4 64 0 103.4.0 152V424c0 48.6 39.4 88 88 88H360c48.6.0 88-39.4 88-88V312c0-13.3-10.7-24-24-24s-24 10.7-24 24V424c0 22.1-17.9 40-40 40H88c-22.1.0-40-17.9-40-40V152c0-22.1 17.9-40 40-40H2e2c13.3.0 24-10.7 24-24s-10.7-24-24-24H88z"/></svg></span></span></a></span></div><div class="flex flex-row flex-wrap items-center"><a class="relative mt-[0.5rem] mr-2" href=/tags/status-update/><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">status-update
</span></span></a><a class="relative mt-[0.5rem] mr-2" href=/tags/consensus/><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">consensus</span></span></a></div></div><div class="flex author"><div class=place-self-center><div class="text-2xl sm:text-lg"></div></div></div><div class="flex author author-extra mt-4"><img class="!mt-0 !mb-0 h-24 w-24 rounded-full ltr:mr-4 rtl:ml-4" width=96 height=96 src=/f1c66b8937bd6938a029cea2fdb21d9b_11706180554726321909_hu_1fd0f9097b9cc146.png><div class=place-self-center><div class="text-[0.6rem] uppercase leading-3 text-neutral-500 dark:text-neutral-400">Author</div><a href=https://abundance.build/authors/adlrocha/ class="font-semibold leading-6 text-neutral-800 dark:text-neutral-300">Alfonso de la Rocha</a><div class="text-2xl sm:text-lg"><div class="flex flex-wrap text-neutral-400 dark:text-neutral-500"><a class="px-1 hover:text-primary-700 dark:hover:text-primary-400" href=https://linkedin.com/in/adlrocha target=_blank aria-label=Linkedin rel="me noopener noreferrer"><span class="inline-block align-text-bottom"><span class="relative block icon"><svg viewBox="0 0 448 512"><path fill="currentColor" d="M416 32H31.9C14.3 32 0 46.5.0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6.0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3.0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2.0 38.5 17.3 38.5 38.5.0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6.0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2.0 79.7 44.3 79.7 101.9V416z"/></svg>
</span></span></a><a class="px-1 hover:text-primary-700 dark:hover:text-primary-400" href=https://x.com/adlrocha target=_blank aria-label=X-Twitter rel="me noopener noreferrer"><span class="inline-block align-text-bottom"><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentColor" d="M389.2 48h70.6L305.6 224.2 487 464H345L233.7 318.6 106.5 464H35.8L200.7 275.5 26.8 48H172.4L272.9 180.9 389.2 48zM364.4 421.8h39.1L151.1 88h-42L364.4 421.8z"/></svg></span></span></a>
<a class="px-1 hover:text-primary-700 dark:hover:text-primary-400" href=https://github.com/adlrocha target=_blank aria-label=Github rel="me noopener noreferrer"><span class="inline-block align-text-bottom"><span class="relative block icon"><svg viewBox="0 0 496 512"><path fill="currentColor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6.0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6.0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3.0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1.0-6.2-.3-40.4-.3-61.4.0.0-70 15-84.7-29.8.0.0-11.4-29.1-27.8-36.6.0.0-22.9-15.7 1.6-15.4.0.0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5.0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9.0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4.0 33.7-.3 75.4-.3 83.6.0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6.0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9.0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
</span></span></a><a class="px-1 hover:text-primary-700 dark:hover:text-primary-400" href=mailto:me@adlrocha.com target=_blank aria-label=Email rel="me noopener noreferrer"><span class="inline-block align-text-bottom"><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentColor" d="M207.8 20.73c-93.45 18.32-168.7 93.66-187 187.1-27.64 140.9 68.65 266.2 199.1 285.1 19.01 2.888 36.17-12.26 36.17-31.49l1e-4-.6631c0-15.74-11.44-28.88-26.84-31.24-84.35-12.98-149.2-86.13-149.2-174.2.0-102.9 88.61-185.5 193.4-175.4 91.54 8.869 158.6 91.25 158.6 183.2v16.16c0 22.09-17.94 40.05-40 40.05s-40.01-17.96-40.01-40.05v-120.1c0-8.847-7.161-16.02-16.01-16.02l-31.98.0036c-7.299.0-13.2 4.992-15.12 11.68-24.85-12.15-54.24-16.38-86.06-5.106-38.75 13.73-68.12 48.91-73.72 89.64-9.483 69.01 43.81 128 110.9 128 26.44.0 50.43-9.544 69.59-24.88 24 31.3 65.23 48.69 109.4 37.49C465.2 369.3 496 324.1 495.1 277.2V256.3c0-149.2-133.9-265.632-287.3-235.57zM239.1 304.3c-26.47.0-48-21.56-48-48.05s21.53-48.05 48-48.05 48 21.56 48 48.05-20.6 48.05-48 48.05z"/></svg></span></span></a></div></div></div></div><div class=mb-5></div></header><section class="flex flex-col max-w-full mt-0 prose dark:prose-invert lg:flex-row"><div class="min-w-0 min-h-0 max-w-fit"><div class="article-content max-w-prose mb-20"><p>This week has been all about objectively assessing the security of the system. After all of the work
around the membership allocation protocol and its security there are still two questions that we
need to answer to understand the feasibility of the protocol: (i) what is the security bound of the
protocol as a whole (from beacon chain to shards), and (ii) how can we ensure that plots are
uniquely identified and that farmers cannot cheat by committing the same plot to different history
sizes to try and game the shard allocation mechanism.</p><h2 class="relative group">Computing the security bound of the protocol<div id=computing-the-security-bound-of-the-protocol class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#computing-the-security-bound-of-the-protocol aria-label=Anchor>#</a></span></h2><p>The beacon chain and all shards in the system run a longest chain consensus. All farmers are
dedicating their storage to protect the beacon chain. From this, we can easily derive that as long
as there&rsquo;s at least 51% of the storage in the system that is honest, the beacon chain will be
secure. Unfortunately, this is not the real security bound for the protocol, as we want to
understand what is the minimum amount of honest storage that we need as a whole (from beacon
chain to shards) to ensure for all shards to be honest with high probability. The overall security bound,
thus, will be determined by the maximum proportion of malicious nodes such that all shards are
secure with a high probability. This means we need to ensure that the probability of any shard
having 50% or more malicious farmers is very low.</p><p>We make the following assumptions to compute this probability:</p><ul><li>Total Malicious Nodes: Let \( p \) be the proportion of malicious nodes in the entire system
(i.e., among all farmers). So, if \( N \) is the total number of farmers, then \( pN \) are
malicious.</li><li>Beacon Chain Security: The beacon chain is secure as long as less than 50% of its participants are
malicious.</li><li>Shard Security: A shard is secure if the proportion of malicious farmers within that shard is less
than 50%.</li><li>Uniform and Random Allocation: Each farmer (malicious or honest) has an equal probability of being
assigned to any given shard, assuming all of them have pledged the same amount of storage. This is
a safe assumptions considering the fact that we are considering plots (and not farmers) as the
basic unit of membership allocation.</li><li>Large Number of Farmers and Shards: For statistical analysis, we&rsquo;ll assume a sufficiently large
number of farmers and shards so that we can use probabilistic approximations. In the script I was
working on last week we can refine these numbers to evaluate the impact of the number of nodes and
shards.</li></ul><p>We base our analysis on the <a href=https://en.wikipedia.org/wiki/Chernoff_bound target=_blank>Chernoff bound</a>, which
provides a way to estimate the probability of deviations from the expected value in a binomial
distribution.</p><blockquote><p>Note: For this analysis I am using farmer and plot indistinctly as if each farmer had a single
plot of maximum size. If you recall from my previous updates, and as described above, we are
considering plots and not farmers as the minimal unit of membership allocation. Farmers are free
to decide how they organise their storage into plots (although rationally, they will try to fit as
much storage as possible into a single plot to reduce the number of shards they need to sync
with).</p></blockquote><p>Let&rsquo;s consider a single shard. Suppose there are \( S \) shards in total, and \( N \) total
farmers. On average, each shard will have \( N/S \) farmers. Let \( n_k \) be the number of
farmers in shard \( k \). Due to random allocation, \( n_k \) will vary, but for large \( N \)
and \( S \), it will be close to \( N/S \).</p><p>Let \(X_i\) be an indicator random variable for farmer \(i\) being malicious.</p><p>For a specific shard \( k \), let \( M_k \) be the number of malicious farmers in that shard. We
want \( M_k / n_k &lt; 0.5 \).</p><p>Since farmers are allocated uniformly and randomly, the distribution of malicious farmers within a
shard can be modeled by a binomial distribution (as discussed in
<a href=https://github.com/nazar-pc/abundance/pull/277 target=_blank>PR277</a>). If a shard has \( n \) farmers, the
number of malicious farmers \( M \) in that shard follows \( B(n, p) \).</p><p>We are interested in the probability that \( M/n \geq 0.5 \). This is \( P(M \geq 0.5n) \).</p><p>For a system to be secure, all shards must be secure. This means we want the probability of at least
one shard being insecure to be very small.</p><p>$$ P(\text{System Insecure}) = P(\exists k \text{ such that } M_k / n_k \geq 0.5) $$</p><p>Using the union bound, we can say:</p><p>$$ P(\text{System Insecure}) \leq \sum_{k=1}^S P(M_k / n_k \geq 0.5) $$</p><p>If we assume all shards have approximately \( n = N/S \) farmers, then:</p><p>$$ P(\text{System Insecure}) \leq S \cdot P(M/n \geq 0.5) $$</p><p>Now, we need to bound \( P(M/n \geq 0.5) \). Since \( E[M/n] = p \), and we want \( M/n &lt; 0.5
\), we need \(p\) to be significantly less than 0.5.</p><p>We can use a Chernoff bound. For a sum of independent Bernoulli random variables, if \( X_1, \dots,
X_n \) are i.i.d. Bernoulli with \( P(X_i = 1) = p \), and \( X = \sum X_i \), then for \(
\delta > 0 \):</p><p>$$ P(X \geq (1+\delta)np) \leq e^{-np\delta^2 / 3} $$</p><p>In our case, we are interested in the upper tail, but when \( p &lt; 0.5 \), we are interested in the
probability that \( M/n \) exceeds its mean. Let&rsquo;s rephrase it. We are looking for the probability
that the observed proportion of malicious nodes \( (M/n) \) is \( \geq 0.5 \), given the true
proportion is \( p \).</p><p>We set \( (1+\delta)p = 0.5 \), so \( \delta = (0.5/p) - 1 \). This bound is for \( \delta > 0
\), which means \( 0.5 > p \). If \( p \geq 0.5 \), the probability of a shard being insecure
becomes very high.</p><p>So, \( P(M/n \geq 0.5) \leq e^{-np((0.5/p)-1)^2 / 3} = e^{-n(0.5-p)^2 / (3p)} \)</p><p>Let \( \epsilon = 0.5 - p \). This is the &ldquo;security margin&rdquo; for each shard. \( P(M/n \geq 0.5)
\leq e^{-n\epsilon^2 / (3p)} \)</p><p>Now, we need \( S \cdot e^{-n\epsilon^2 / (3p)} \) to be very small (e.g., \( 10^{-6} \) or \(
10^{-9} \)).</p><p>To provide a general number, we need to define the acceptable probability of an insecure system. Let
this be \( \alpha \).</p><p>The condition for system security is roughly:</p><p>$$ \frac{N}{S} \cdot e^{-n(0.5-p)^2 / (3p)} &lt; \alpha $$</p><p>Where:</p><ul><li>\(N\): <strong>Total number of farmers</strong> in the system.</li><li>\(n\): <strong>Average number of farmers per shard</strong> (\( n=N/S \), where \( S \) is the number of
shards).</li><li>\(p\): <strong>Proportion of malicious farmers</strong> in the entire system.</li><li>\(\alpha\): <strong>Acceptable probability of the overall system being secure</strong> (e.g., \( 10^{-6}
\) for very high security).</li></ul><p>You would then solve for \(p\). As shown in the example, this often leads to a quadratic
inequality.</p><h2 class="relative group">Translating it into numbers<div id=translating-it-into-numbers class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#translating-it-into-numbers aria-label=Anchor>#</a></span></h2><p>Based on the analysis, the percentage of malicious nodes (\( p \)) that the overall system can
afford will be <strong>significantly less than 50%</strong>. The exact value depends critically on:</p><ul><li>The <strong>total number of farmers</strong> (\( N \)) in the system.</li><li>The <strong>number of shards</strong> (\( S \)) you choose, which determines the average number of farmers
per shard (\( n \)).</li><li>The <strong>desired probability of the overall system being secure</strong> (\( \alpha \)).</li></ul><p>As a rule of thumb, to achieve a high degree of confidence that all shards remain secure, \( p \)
will likely need to be in the range of <strong>30-45%</strong>, depending on the specific parameters (\( N, S,
\alpha \)). It will always be a value smaller than 50% and decrease as the number of shards
increases (for a fixed total number of farmers) or as the desired security level increases.</p><p>To get the specific bound we need to choose the specific parameters desired (\( N, S, \) and \(
\alpha \)) and then calculate the \( p \) value using the Chernoff bound (or a similar
concentration inequality) to get a precise answer for your design.</p><p>If we, for instance, consider total number of farmers \( N = 1000 \), number of shards \( S = 100
\), and an average number of farmers per shard \( n=N/S=10,000 \) with a security level of \(
\alpha = 10^{-2} (1%)\), we get that \( p \) should be approximately less than 46.42%.</p><p>The trade-off between the number of shards (which improves scalability) and the security threshold
(\( p \)) is clear, and it aligns with our intuition so far. More shards mean each shard has fewer
farmers (for a fixed total number of farmers), making individual shards more susceptible to higher
concentrations of malicious nodes.</p><h2 class="relative group">Realising plot Uniqueness<div id=realising-plot-uniqueness class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#realising-plot-uniqueness aria-label=Anchor>#</a></span></h2><p>In Subspace, plots do not have a unique identifier, and are sectors (that conform a plot) the ones
uniquely identified. This is the way in which is done: <em>sectors are indexed sequentially and for
each sector their ID is derived through
<code>sector_id = keyed_hash(public_key_hash, sector_index || history_size)</code>, where <code>sector_index</code> is the
sector index in the plot and <code>history_size</code> is the current history size at the time of sector
creation.</em> This means that farmers can easily create sectors with the same sector index that commit
to different history sizes so they can keep them around to include them in a plot when is convenient
for them to achieve the desired allocation.</p><p>To prevent this attack, the idea is to assign a unique identifier to each plot that bounds the plot
to a specific window of history sizes, and uniquely assign sectors to plots based on this (i.e.
sectors from a plot need to be committed to a specific history size in the range bound by the plot).
Additionally, the specific size of the history size window allowed for a plot will depend on the
maximum size that the farmer want to assign to that plot. This way, we limit the surface of the
attack were a farmer tries to create different sectors with the same sector ID in a plot to try and
bias the allocation of shards in their favour.</p><p>Thus, this is how the plot and sector IDs are derived and bound together:</p><pre tabindex=0><code>plot_id = keyed_hash(public_key_hash, max_plot_size || min_history_size || max_history_size)

sector_id = keyed_hash(plot_id, sector_index || history_size)
</code></pre><p>With this approach we are:</p><ul><li>Preventing Double-Committing Sectors: A farmer cannot commit the &ldquo;same&rdquo; sector ID to different
<code>history_size</code> values and then choose the most convenient one for membership. Why? Because the
<code>history_size</code> is part of the <code>sector_id</code>. If <code>history_size_A</code> is used, it produces <code>sector_id_A</code>.
If <code>history_size_B</code> is used, it produces <code>sector_id_B</code>. These are distinct. If both
<code>history_size_A</code> and <code>history_size_B</code> fall within the <code>[min_history_size, max_history_size]</code> range
of the <em>same</em> <code>plot_id</code>, the farmer would effectively be storing two <em>different</em> sectors (with
different piece selections) at the same <code>sector_index</code> within that plot, which is impossible. Each
<code>(plot_id, sector_index)</code> pair uniquely maps to a single valid <code>sector_id</code> based on its
<code>history_size</code> at creation time.</li><li>Ensuring Verifiability: All parameters necessary for <code>plot_id</code> and <code>sector_id</code> derivation are
either public (on-chain registered <code>plot_id</code>s) or committed by the farmer in proofs
(<code>sector_index</code>, <code>history_size</code>). This allows full independent verification by any node. The
<code>max_plot_size</code> parameter in the <code>plot_id</code> ensures that farmers must commit to a specific maximum
plot capacity upfront, preventing them from retroactively adjusting plot boundaries to game the
allocation mechanism. If we don&rsquo;t want to make the history window size have to be shared in
plaintext off-band, and we want the verification to be self-contained, we can force a specific
size for the history window (so it is enough with sharing the beginning of the history window), or
we can make a commitment on the history window size so that given the history size that a sector
is committed to, we can succinctly verify that the sector is valid for that history size of the
plot. This verifiability will allow us to include membership allocation proofs in the block
proposal to verify that the farmer is entitled to propose a block in that shard.</li></ul><h2 class="relative group">What&rsquo;s next?<div id=whats-next class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#whats-next aria-label=Anchor>#</a></span></h2><p>We are making pretty good progress on surfacing all the existential risks to the system and
modelling it in a way that allows us to clearly reason about the different trade-offs we may incur
in. Unless something unexpected comes up, my focus for the week is to:</p><ul><li>Embed the high-level plot ID proposal that I shared into the membership allocation protocol for
verification.</li><li>With this, continue modeling the security of membership allocation and the security of the
protocol as a whole so we can have a clearer model of this looks like, and if this design satisfy
our security requirements without the need of fraud proofs or off-band mechanisms.</li><li>Finally, I want to spend some time fleshing out the segment submission description from
<a href=https://github.com/nazar-pc/abundance/pull/267 target=_blank>PR267</a> after the most recent feedback to start
integrating into the block proposal in shards (as Nazar has already made good progress to make
this work practically and it would be great to unblock him).</li></ul></div></div><script type=text/javascript src=/js/page.min.54b6f4371722649edbe871e431d8670d670878c22be8f36e229fe53cc9b786fe25a834def5e6de621f7a3e37b72bc8cd73839aa5ed907ed6cbd45cd3e1b0fa20.js integrity="sha512-VLb0NxciZJ7b6HHkMdhnDWcIeMIr6PNuIp/lPMm3hv4lqDTe9ebeYh96Pje3K8jNc4Oape2QftbL1FzT4bD6IA==" data-oid=views_blog/2025-06-16-thinking-about-security.md data-oid-likes=likes_blog/2025-06-16-thinking-about-security.md></script></section><footer class="pt-8 max-w-prose print:hidden"><div class=pt-8><hr class="border-dotted border-neutral-300 dark:border-neutral-600"><div class="flex justify-between pt-3"><span><a class="flex group mr-3" href=/blog/2025-06-09-modelling-farmer-membership-allocation/><span class="mr-3 text-neutral-700 group-hover:text-primary-600 ltr:inline rtl:hidden dark:text-neutral dark:group-hover:text-primary-400">&larr;</span>
<span class="ml-3 text-neutral-700 group-hover:text-primary-600 ltr:hidden rtl:inline dark:text-neutral dark:group-hover:text-primary-400">&rarr;</span>
<span class="flex flex-col"><span class="mt-[0.1rem] leading-6 group-hover:underline group-hover:decoration-primary-500">Modelling farmer membership allocation</span>
<span class="mt-[0.1rem] text-xs text-neutral-500 dark:text-neutral-400"><time datetime=2025-06-09T00:00:00+00:00>9 June 2025</time>
</span></span></a></span><span><a class="flex text-right group ml-3" href=/blog/2025-06-16-beacon-chain-block-processing-infrastructure/><span class="flex flex-col"><span class="mt-[0.1rem] leading-6 group-hover:underline group-hover:decoration-primary-500">Beacon chain block processing infrastructure</span>
<span class="mt-[0.1rem] text-xs text-neutral-500 dark:text-neutral-400"><time datetime=2025-06-16T00:00:00+00:00>16 June 2025</time>
</span></span><span class="ml-3 text-neutral-700 group-hover:text-primary-600 ltr:inline rtl:hidden dark:text-neutral dark:group-hover:text-primary-400">&rarr;</span>
<span class="mr-3 text-neutral-700 group-hover:text-primary-600 ltr:hidden rtl:inline dark:text-neutral dark:group-hover:text-primary-400">&larr;</span></a></span></div></div></footer></article><div id=top-scroller class="pointer-events-none absolute top-[110vh] bottom-0 w-12 ltr:right-0 rtl:left-0 z-10"><a href=#the-top class="pointer-events-auto sticky top-[calc(100vh-5.5rem)] flex h-12 w-12 mb-16 items-center justify-center rounded-full bg-neutral/50 text-xl text-neutral-700 hover:text-primary-600 dark:bg-neutral-800/50 dark:text-neutral dark:hover:text-primary-400" aria-label="Scroll to top" title="Scroll to top">&uarr;</a></div></main><footer id=site-footer class="py-10 print:hidden"><div class="flex items-center justify-between"><p class="text-sm text-neutral-500 dark:text-neutral-400"><a href=https://creativecommons.org/publicdomain/zero/1.0/ target=_blank rel="license noopener noreferrer">CC0 1.0 Universal</a></p><p class="text-xs text-neutral-500 dark:text-neutral-400">Powered by <a class="hover:underline hover:decoration-primary-400 hover:text-primary-500" href=https://gohugo.io/ target=_blank rel="noopener noreferrer">Hugo</a> & <a class="hover:underline hover:decoration-primary-400 hover:text-primary-500" href=https://blowfish.page/ target=_blank rel="noopener noreferrer">Blowfish</a></p></div><script>mediumZoom(document.querySelectorAll("img:not(.nozoom)"),{margin:24,background:"rgba(0,0,0,0.5)",scrollOffset:0})</script><script type=text/javascript src=/js/process.min.ee03488f19c93c2efb199e2e3014ea5f3cb2ce7d45154adb3399a158cac27ca52831db249ede5bb602700ef87eb02434139de0858af1818ab0fb4182472204a4.js integrity="sha512-7gNIjxnJPC77GZ4uMBTqXzyyzn1FFUrbM5mhWMrCfKUoMdsknt5btgJwDvh+sCQ0E53ghYrxgYqw+0GCRyIEpA=="></script></footer></div></body></html>